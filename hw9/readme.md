# Homework 9

This is the readme file for Homework 9 of the Numeric Analysis course.

## Problem Statement

### code_rk
应用RKF-45或RKF-54方法，设计实现自适应方法，求解如下常微分方程初值问题：
$$y'=e^{xy}+cos(x-y)$$
$$y(1)=3$$
初值步长取为$h = 0.01$. 在自适应方法中步长的选取采用第二种策略。

在解溢出前终止。

程序的输出：

1 解的范围: $[1, ?]$

2 提示输入一个介于上述范围的值，应用简单的两点线性插值计算出对应的函数值。

### code_mu
初值问题
$$x'=\frac{t-e^{-t}}{x+e^x}$$
$$x(0)=0$$

该方程的真解由以下等式给出
$$x^2-t^2+2e^x-2e^{-t}=0$$

$t=1$时，求解$x$作为参考的准确解，利用Adams-Bashforth公式计算方程在$t = 1$的数值解，利
用Runge-Kunta格式得到初值，取节点$x_i , i = 0, · · · , N$,
$N$为$2^k , k = 3, · · · , 8$,并给出误差表格

## Approach

### code_rk
Runge-Kutta-Fehlberg的6次函数求值如下：
$$f_{1}=hf(x,y)$$
$$f_2 = hf(x+h/4,y+f_1/4)$$
$$f_3 =hf(x+3h/8,y+(3f_1+9f_2)/32)$$
$$f_4 =hf(x+12h/13,y+(1932f_1-7200f_2+7296f_3)/2197)$$
$$f_5 =hf(x+h,y+439f_1/216-8*f_2+3680f_3/513-845f_4/4104)$$
$$f_6 =hf(x+h/2,y-8f_1/27+2f_2-3544/2565f_3+1859/4101f_4-11/40f_5)$$

RKF-54求得的$y(x+h)$为
$$y(x+h)=y(x)+16/135f_1+6656/12825f_3+28561/56430f_4-9/50f_5+2/55f_6$$

局部截断误差估计式
$$error =f_1/360-128f_3/4275-2197f_4/75240+f_5/50+2f_6/55$$

第二种策略中下一次操作的步长$h$取值为
$$h=0.9 h(\frac{\delta}{|error|})^{1/5}$$

### code_mu

利用作业8中的四阶Runge-Kutta格式得到初值，Adams-Bashforth公式如下
$$y_{n+1}=y_n+\frac{h}{720}(1901f_n-2774f_{n-1}+2616f_{n-2}-1274f_{n-3}+251f_{n-4})$$
