# 第六周程序作业

## Problem

### codein

对函数$f(x)=\frac{1}{25x^2+1}，x\in [-1,1]$，构造Lagrange插值多项式$p_L(x)$，插值节点取为:

1. $x_i=1-i \frac{2}{N}, i = 0, 1, · · · , N$

2. $x_i = −cos(\frac{i + 1}{N + 2}\pi), i = 0, 1, · · · , N$ (Chebyshev point)

利用$\int_{-1}^{1} p_L(x) \,dx $计算$\int_{-1}^{1} f(x) \,dx $的近似值，并计算如下误差

$$ \left\lvert \int_{-1}^{1} p_L(x)-f(x) \,dx \right\rvert $$

对N = 5, 10, 15, 20, 25, 30, 35, 40比较以上两组节点的结果。

### code5

分别编写用复化Simpson积分公式和复化梯形积分公式计算积分的通用程序,用如上程序计算积分
$$I_1(f) = \int_{0}^{4} sin(x) \,dx , I_2(f ) = \int_{0}^{2\pi} sin(x) \,dx $$

取节点$x_i, i = 0, · · · , N,$ $N$为$2^k, k = 1, · · · , 12$,并分析误差

利用公式计算算法的收敛阶$$ Ord=\frac{ln(Error_{old}/Error_{now})}{ln(N_{now}/N_{old})} $$.

## Method

### codein

利用之前编写的计算Lagrange程序，计算$p_L(x)$，进行积分计算比较$ \left\lvert \int_{-1}^{1} p_L(x)-f(x) \,dx \right\rvert $。

### code5

复化的Simpson公式为$$\int_{a}^{b} f(x) \,dx \approx \sum_{i = 1}^{[\frac{n}{2}]} \frac{x_{2i}-x_{2i-2}}{6}[f(x_{2i})+4f(x_{2i-1})+f(x_{2i-2})]$$

复化的梯形公式为$$\int_{a}^{b} f(x) \,dx \approx \sum_{i = 1}^{n} \frac{1}{2}[f(x_i)+f(x_{i-1})](x_i-x_{i-1})$$

编写程序求数值积分。

## Result

### codein

|n |equal distance error | Chebyshev point error |
|---|---|---|
|      5|8.782185e-02 |  6.821986e-02|
 |     10|3.852998e-01  | 4.725383e-03|
 |     15|2.817515e-01 |1.774181e-03|
 |     20|5.919271  | 6.504848e-04|
 |     25|5.949221   |3.946928e-07|
 |     30|1.532486e+02   |3.866523e-05|
 |     35|1.733310e+02   |3.234144e-06|
 |     40|4.912966e+03   |4.506167e-06|

### code5

|$2^k$ |梯形公式 error |Simpson公式 error| 梯形公式order  | Simpson公式order|
|---|---|---|---|---|
|    N=2     | 5.918513e-01   | 2.666145e-01| ||
|    N=4     | 1.401564e-01   | 1.040849e-02     | 2.078197   | 4.678923 |
|    N=8     | 3.459531e-02   | 5.917309e-04     | 2.018390   | 4.136676 |
|    N=16     | 8.621712e-03   | 3.615514e-05     | 2.004530   | 4.032669 |
|    N=32     | 2.153743e-03   | 2.247077e-06     | 2.001128   | 4.008079 |
|    N=64     | 5.383305e-04   | 1.402463e-07     | 2.000282   | 4.002014 |
|    N=128     | 1.345761e-04   | 8.762338e-09     | 2.000070   | 4.000503 |
|   N=256     | 3.364360e-05   | 5.475989e-10     | 2.000018   | 4.000125 |
|   N=512     | 8.410875e-06   | 3.422462e-11     | 2.000004   | 4.000013 |
|    N=1024     | 2.102717e-06   | 2.139400e-12     | 2.000001   | 3.999757 |
|    N=2048     | 5.256792e-07   | 1.318945e-13     | 2.000000   | 4.019750 |
|    N=4096     | 1.314198e-07   | 6.439294e-15     | 2.000000   | 4.356338|
